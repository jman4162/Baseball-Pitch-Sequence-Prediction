# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This repository explores baseball pitch sequence prediction using multiple ML approaches. All code lives in Jupyter notebooks (originally developed in Google Colab). There is no build system, test suite, or linting configuration — the project is notebook-driven.

## Running Notebooks

The project uses a Python 3.9 venv at `./venv/`. To run notebooks locally:

```bash
source venv/bin/activate
jupyter notebook
```

Notebooks were originally developed in Google Colab and can be opened there directly via GitHub.

## Architecture

The project follows a pipeline: **synthetic data generation → model training → evaluation**.

### Notebooks (in logical order)

1. **`Baseball_Pitch_Sequence_Simulator.ipynb`** — Generates synthetic training data using Markov models. Defines transition probabilities for each ball-strike count state, simulates at-bats via `BaseballPitchSimulator` class, and outputs `data/baseball_pitch_data.csv`. This is the data source for the AutoGluon notebooks.

2. **`HMM_Pitch_Predictor.ipynb`** — Generates a second synthetic dataset (`data/synthetic_pitch_sequences.csv`) using a simpler transition matrix (no count context, just pitch-to-pitch transitions). Trains a `CategoricalHMM` from `hmmlearn`, sweeping 1–8 hidden states and selecting by accuracy. Best model saved as `best_sequence_model.pkl`.

3. **`AutoGluon_Baseball_Pitch_Prediction.ipynb`** — Uses AutoGluon TabularPredictor to predict **PitchType** (Fastball/Slider/Curveball/Changeup) from Balls, Strikes, and PreviousPitchType. Uses `good_quality` preset.

4. **`AutoGluon_Baseball_Pitch_Outcome_Prediction.ipynb`** — Uses AutoGluon TabularPredictor to predict **Outcome** (ball/strike/hit) from Balls, Strikes, PitchType, and PreviousPitchType. Same structure as notebook 3 but different target variable.

### Datasets

- **`data/baseball_pitch_data.csv`** — Columns: `Balls, Strikes, PitchType, Outcome`. ~378K rows of simulated at-bat pitches with count context. Generated by notebook 1.
- **`data/synthetic_pitch_sequences.csv`** — 2,500 sequences of 100 pitches each (columns `Pitch_1` through `Pitch_100`). Generated by notebook 2.

### Key Dependencies

- `autogluon` (TabularPredictor for AutoML)
- `hmmlearn` (CategoricalHMM)
- `pandas`, `numpy`, `scikit-learn`, `matplotlib`, `seaborn`, `torch`

### Known Limitations

- The AutoGluon pitch type predictor collapses to predicting "Fastball" for every input (~50% accuracy) due to the simplistic Markov-generated data.
- The HMM achieves ~31% accuracy (best with 5 hidden states), also limited by the synthetic data's simplicity.
- The README notes planned but not yet implemented: attention-based transformer and LSTM sequence prediction models.

## Pitch Types and Outcomes

- **Pitch types**: Fastball, Slider, Curveball, Changeup
- **Outcomes**: ball, strike, hit
- **Count states**: (balls, strikes) where balls ∈ [0,3], strikes ∈ [0,2]
